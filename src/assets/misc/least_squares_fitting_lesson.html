<!doctypehtml><html class="idc0_343 lhuobpds"lang="en-US"><link data-savepage-href="https://brownmath.com/pic/logo.ico"href="data:image/x-icon;base64,AAABAAEAICAAAAEAGACoDAAAFgAAACgAAAAgAAAAQAAAAAEAGAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAAA//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A////AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA=="rel="icon"><meta charset="windows-1252"><meta content="width=device-width,initial-scale=1"name="viewport"><title>Least Squares — the Gory Details</title><link data-savepage-href="../pic/logo.ico"href="data:image/x-icon;base64,AAABAAEAICAAAAEAGACoDAAAFgAAACgAAAAgAAAAQAAAAAEAGAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAAA//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A////AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAD/AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA=="rel="SHORTCUT ICON"><style data-savepage-href="../brm.css">body{font-family:Cambria,Georgia,serif;font-size:100%;color:#000;background-color:#fffff4;background-image:none;max-width:40em;margin:0 auto;padding:.5em}@media print{body{font-family:"Palatino Linotype",Palatino,"Book Antiqua","Lucida Bright",serif;font-size:10pt;background-color:#fff;max-width:none;margin:0 .5em;padding:0}}@media screen{body.bottompadding{padding-bottom:80vh}body.swt{padding-bottom:5em}}.maintitle,address,blockquote,dd,div.Summary,div.quiz,dt,li,p,td,th{font-family:Cambria,Georgia,serif;font-size:100%;color:#000;background-color:transparent;line-height:1.4}@media print{.maintitle,address,dd,div.quiz,dt,li,p,td,th{font-family:"Palatino Linotype",Palatino,"Book Antiqua","Lucida Bright",serif;font-size:10pt}}div,dt,p{margin:1em 0 0 0;text-indent:0;padding:0}div.quiz{clear:both}p+p,p.nonbrk{margin-top:0;text-indent:2em}.nospaceafter{margin-bottom:0}.nospaceafter+p{margin-top:0}div.newsec,p.brk,p.newsec{margin-top:1em;text-indent:0}p.algebra{margin:0 0 0 2em;text-indent:2em}p.hanging{margin-top:1em;margin-left:2em;text-indent:-2em}p.hanging2{margin-top:0;margin-left:2em;text-indent:2em}div.hanging{margin-left:2em}div.hanging p.hanging{margin-left:0}p.news{margin-top:2.5em;text-indent:0}.secondhalf{margin-top:0;text-indent:0}p.source{margin-top:0;text-align:right;text-indent:0}p.writein{margin-top:2em;text-indent:0}@media print{p.writein{margin-top:3em;line-height:2.5}}.Summary{margin-left:6.5em;margin-top:1em;text-indent:0}.SummaryH{float:left;margin-left:-6.5em;width:6.5em}div.btw,div.btwroman,p.btw,p.btwroman{margin-left:3em;font-size:90%;font-style:italic;margin-top:1em;text-indent:0}div.btwroman,p.btwroman{font-style:normal}div.btw:before,div.btwroman:before,p.btw:before,p.btwroman:before{content:"BTW: ";font-style:normal}div.btw cite,div.btw code,div.btw em,div.btw i,p.btw cite,p.btw code,p.btw em,p.btw i{font-style:normal}.fineprint{font-size:83.33%;line-height:1.2;margin:1.25em 0}.illo{margin-top:1em;text-indent:0;text-align:center}.illotight{margin-top:0;text-indent:0;text-align:center}.motto{font-size:133%;margin:.75em 2.26em;padding:1em;text-indent:0;text-align:left;border:double #808}.boxin{margin:1em 2.5em;padding:.5em;border:medium solid #008;page-break-inside:avoid}.boxin table.mynb{margin-top:0}.boxedeq{clear:both;margin:1em 0;page-break-inside:avoid;border:1px solid #00c}.boxedeq p{margin:.5em;text-indent:0}span.yields{padding:0 2em}pre{font-family:"Lucida Sans Typewriter","Courier New","Lucida Console",Courier,monospace;font-size:90%;line-height:1.2;margin:1em 0 0 0;padding:0;border:none}@media print{pre{font-family:"Lucida Sans Typewriter","Courier New","Lucida Console",Courier,monospace;font-size:9pt}}pre.codeline{margin:0 0 0 5em}blockquote{font-size:92%;margin:1em 3em 1em 4em;padding:.5em;border-left:2px solid #00c}blockquote pre{font-style:normal}div.begdon,div.begdonnarrow{margin-top:1em;padding:1em 1em;font-family:Helvetica,Tahoma,sans-serif;color:brown;font-size:12pt;line-height:14pt;text-align:center;background-color:#e8e8ff;border:thin solid brown;page-break-inside:avoid}div.begdonnarrow{max-width:25em;margin-left:auto;margin-right:auto}div.begdon a{color:brown;text-decoration:none;background-color:transparent}@media print{div.begdon a{font-weight:700}}.fl{float:left;margin:.25em .5em .25em 0;padding:0}.fr,.fr0{float:right;margin:.25em 0 .25em .5em;padding:0}.fr0{margin-top:0!important}.clear,.newsec,.newsec2{clear:both}.newsec2{margin-top:2em;text-indent:0}div.clear{margin:0;padding:0;height:0;line-height:0;font-size:1pt}.pagesec{clear:both;margin-top:2em;text-indent:0}@media print{.pagesec{margin-top:0;page-break-before:always}.chapterend{page-break-after:always}}@media screen{.chapterend{margin-top:3em}}.purelist ul,ul{margin:0 0 0 4em;padding:0}ul.purelist{margin-left:.6em;padding-left:.6em}ol{margin:0 0 0 4em;padding:0}ol.purelist{margin:0 0 0 2.5em;padding-left:0}ol ol{list-style:lower-roman}ol ol,ol ul,ul ol,ul ul{margin-left:2em}li{margin:0;padding:0}.loose li,.veryloose .loose li{margin-top:.33em}ol.loose,ul.loose{margin-bottom:.33em}.veryloose li{margin-top:1em}ol.veryloose,ul.veryloose{margin-bottom:1em}ol.loose li li,ol.veryloose li li,ul.loose li li,ul.veryloose li li{margin:0}ul li.nobullet{list-style-type:none}dl{margin:0;padding:0}dt{margin:1em 0 0 0;text-indent:0;padding:0}dd{margin:0 0 0 4em;padding:0}ul.TOC{margin-left:0;padding-left:0;list-style-type:none}ul.TOC li{padding-left:4em;text-indent:-4em;margin-top:.25em}ul.TOC ul{margin-left:-2em;padding-left:0;list-style-type:none}ul.TOC ul li{margin-top:0}ul.TOC ul ul li:before{content:'\00B7\00A0'}.big{font-size:133%}.small,small{font-size:83.33%}sup{vertical-align:baseline;position:relative;bottom:1ex}sub{vertical-align:baseline;position:relative;top:.8ex}img{page-break-inside:avoid}a img{border:none}code,kbd,tt{font-family:monospace;font-size:90%;white-space:nowrap}samp{font-family:monospace;font-size:90%}@media print{code,kbd,samp,tt{font-family:"Lucida Sans Typewriter","Courier New","Lucida Console",Courier,monospace}}var{font-family:Cambria,Georgia,serif;font-style:italic}@media print{var{font-family:"Palatino Linotype",Palatino,"Book Antiqua","Lucida Bright",serif}}dfn{font-weight:700;color:#008;background-color:transparent}.key{font-weight:700;color:#008;background-color:transparent}.answer{border:1px solid #00c;padding:.3em .25em .2em;color:#000;background-color:#e8e8ff}@media print{.answer{background-color:#f4f4ff}}strong.news{font-size:150%;padding-right:2em}span.dropnumber{font-family:sans-serif;font-size:200%;font-weight:700;color:#008;background-color:transparent;float:left;padding:0 .1em 0 0;margin:0 .25em 0 0}@media print{span.dropnumber{font-family:Tahoma,Helvetica,Arial,sans-serif}}.eqnumber{float:right;text-align:right;vertical-align:middle;width:3em}span.radical{border-top:solid 1px #000}sup.radicalindex{margin-right:-.5em;vertical-align:.4em}.cmd,.fname,.fnamelit{font-family:sans-serif;font-style:oblique;font-size:90%}@media print{.cmd,.fname,.fnamelit{font-family:Tahoma,Helvetica,Arial,sans-serif}}.fname{text-transform:uppercase}.cmd{text-transform:lowercase}.menu{font-style:italic}a:link{color:#00d;text-decoration:underline;background-color:transparent}a:visited{color:#808;text-decoration:underline;background-color:transparent}abbr{text-decoration:none;border:none;border-bottom:1px dotted #008}@media print{abbr{border-bottom:0}}@media print{#crummenu a,ul.TOC a,ul.TOCNOBULLET a{text-decoration:none}a:link,a:visited{color:inherit}a.showURL{text-decoration:none}a.showURL:after{content:" [URL " attr(href) " " attr(title) "]"}a.titlURL{text-decoration:none}a.titlURL:after{content:" [URL: " attr(title) "]"}}@media screen{a:focus,a:hover{color:#008;text-decoration:none;background-color:#ffffd0}a:active{color:red;text-decoration:none;background-color:transparent}}.secondheader{margin-top:.5em}h1,h2,h3,h4,h5{font-family:sans-serif;color:#008;font-weight:700;border:none;page-break-after:avoid}@media print{h1,h2,h3,h4,h5{font-family:Tahoma,Helvetica,Arial,sans-serif}}h1{clear:both;font-size:175%;line-height:normal;text-align:center;margin:.57em 0 .5em;padding:.77em 1em;border:3px solid #00c}.maintitle{clear:both;font-size:100%;text-align:center;font-weight:700;color:#008;margin:1em 0 .5em;padding:1em;border:3px solid #00c}.maintitle h1{margin:0 0 .5em 0;padding:0;border:none}.maintitle p{font-size:100%;text-align:center;text-indent:0;font-weight:700;color:#008;margin-left:auto;margin-right:auto}.maintitle p.line2h1,.maintitle p.subh1{font-family:sans-serif;font-weight:700;font-size:137.5%;margin:0 0 .5em 0}.maintitle p.line2h1{font-size:200%}@media print{.maintitle p .subh1{font-size:132%}}.maintitle .key{font-weight:700;color:#008}h2{font-size:125%;line-height:normal;text-align:left;clear:both;margin:2em 0 1.5em;padding:.77em 0 .77em .8em}@media print{h2{padding-left:0;border-top:2px solid #00c;border-bottom:2px solid #00c}h2.nopagesec{margin-top:6em}}.maintitle,.maintitle p,h1,h2{background-color:#e8e8ff}@media print{.maintitle,.maintitle p,h1,h2{background-color:#f4f4ff}}h3{font-size:110%;line-height:normal;text-align:left;margin:2em 0 1em;padding:.5em 0 .5em .91em;border-bottom:1px solid #00c}@media print{h3{padding:.77em 0;border-top:2px solid #00c;border-bottom:none}h2+h3{border-top:none}}h4{font-size:100%;text-align:left;margin:1.5em 0 1em 4em;padding:.5em 0}@media print{h4{font-style:italic;margin-left:3em}}h5{font-size:90%;font-style:italic;text-align:left;margin:1.5em 0 1em 7em;padding:.5em 0;border:none}table{margin:1em 0 0 0;padding:0}th{font-weight:700}table tr th{text-align:center}table tbody tr th{text-align:left}table.noborder tr td,table.noborder tr th{border:none!important;padding:0!important}table.centered{margin-left:auto!important;margin-right:auto!important}div.acchild{margin-top:0}div.acchild table{margin-left:auto;margin-right:auto;text-align:left}table.acchild tr td,table.acchild tr th{text-align:center}.atchild tr td,.atchild tr th{vertical-align:top}table.myctr,table.mynum,table.mystd{border-collapse:collapse;border:none}table.myctr td,table.myctr th,table.mynum td,table.mynum th,table.mystd td,table.mystd th{border:2px solid #000;padding:.3em .5em}table tbody tr th,table.mystd tr td{text-align:left;vertical-align:top}table.myctr tr td{text-align:center;vertical-align:middle}table.mynum tr td{text-align:right;vertical-align:bottom}table.myctr thead td,table.mynum thead td,table.mystd thead td{border-left:none;border-top:none}table.mynb td,table.mynb th{padding:.25em .4em .25em 0}table.mynbtight td,table.mynbtight th{padding:0 .4em 0 0}table.mynb td+td,table.mynb th+td,table.mynb th+th,table.mynbtight td+td,table.mynbtight th+td,table.mynbtight th+th{padding-left:.4em}table.mynb th,table.mynbtight th{text-align:center;vertical-align:top}table.mynb tbody tr th,table.mynb td,table.mynbtight tbody tr th,table.mynbtight td{text-align:left;vertical-align:top}table.parallel{clear:both;margin-top:1em;width:100%;border:none;border-collapse:collapse}table.parallel td,table.parallel th{vertical-align:top}table.parallel th{text-align:left;padding-bottom:1em}table.parallel .left{padding-right:1em;border-right:thin solid #000}table.parallel .leftnb{padding-right:1em}table.parallel .right{padding-left:1em}table#submap{margin-left:auto;margin-right:auto}table#submap td,table#submap th{vertical-align:top}table#submap th.h2{font-family:sans-serif;color:#008;font-weight:700;border:none;font-size:125%;line-height:normal;text-align:left;text-indent:0;margin:0;padding-top:.25em}table#submap tbody tr td{padding-left:1em}table.ti8389proc,table.ti83proc{margin:1em 0;clear:both;width:100%;border-collapse:separate;border-spacing:0}table.ti8389proc+table.ti83proc,table.ti83proc+table.ti8389proc{margin-top:0}table.ti8389proc td,table.ti83proc td{padding:1em 0 0;text-align:left;vertical-align:top}table.ti8389proc tr:first-of-type td,table.ti83proc tr:first-of-type td{padding-top:0}.ti83proc td.ti83conc{width:40%}.ti83proc td.ti83step{width:60%}.ti8389proc td.ti83conc{width:30%}.ti8389proc td.ti83step{width:35%}.ti8389proc td.ti89step{width:35%}.ti8389proc td.ti83conc,.ti83proc td.ti83conc{padding-right:8px}.ti8389proc td.ti83step,.ti8389proc td.ti89step,.ti83proc td.ti83step{padding-left:8px;padding-right:8px;background-color:#f0f0f0}.ti8389proc td.ti89step{border-left:1px solid #000}.s{text-decoration:line-through}.u{text-decoration:underline}.unicode{font-family:"Arial Unicode MS",Cambria,Code2000,"Lucida Sans Unicode"}@media print{.nonprint{display:none}}@media screen{.onlyprint{display:none}}.senzastil{display:none}.nopagebreak{page-break-inside:avoid}.al,.al1{text-align:left!important}.al1{text-indent:1em!important}.ac,.acm{text-align:center!important;text-indent:0!important}.ar{text-align:right!important}.at{vertical-align:top!important}.acm,.am{vertical-align:middle!important}.ab{vertical-align:bottom!important}form.search,form.search div{margin:0}#crummenu{font-family:sans-serif;color:#000;background-color:#ffffd0;font-size:80%;margin:.63em 0 0;padding:.5em .5em .7em}@media print{#crummenu{font-family:Tahoma,Helvetica,Arial,sans-serif;font-size:9pt;margin-top:0;padding-top:0;background-color:transparent}}#crumrevdate{float:right;margin:0;padding-left:2em}div#fixedcrumbs,p.whyl{font-family:sans-serif;font-size:80%;background-color:#ffffd0}div#fixedcrumbs{position:fixed;bottom:0;left:0;right:0;z-index:10;margin:0;padding:.625em}p.whyl{clear:both;margin:3em 0;padding:.5em;text-indent:0}div#crumcontent{max-width:50em;margin:0 auto}div#swtsearch{float:right;margin-top:0;margin-bottom:0}div#swtnav{margin:0}@media print{div#fixedcrumbs,p.whyl{display:none}}#pageend{clear:both;font-size:90%;margin:1em 0 0;padding-top:.5em}#pageend.bordered{border-top:2px solid #00c}#pageend p.source{margin-top:1em}p.brmwrapup{margin:.5em 0 0;padding:0;text-indent:0}p.brmwrapup+p.brmwrapup{margin-top:0}</style><style>table th,table tr td{padding-left:1em;padding-right:1em}</style><meta content="Derivation of Least-Squares Linear Regression"name="description"><style id="savepage-cssvariables"></style><script id="savepage-shadowloader">"use strict";function savepage_ShadowLoader(a){!function e(n,t){var o;if("iframe"==t.localName||"frame"==t.localName){if(n<a)try{null!=t.contentDocument.documentElement&&e(n+1,t.contentDocument.documentElement)}catch(e){}}else{if(1<=t.children.length&&"template"==t.children[0].localName&&t.children[0].hasAttribute("data-savepage-shadowroot"))for(t.attachShadow({mode:"open"}).appendChild(t.children[0].content),t.removeChild(t.children[0]),o=0;o<t.shadowRoot.children.length;o++)null!=t.shadowRoot.children[o]&&e(n,t.shadowRoot.children[o]);for(o=0;o<t.children.length;o++)null!=t.children[o]&&e(n,t.children[o])}}(0,document.documentElement)}window.addEventListener("DOMContentLoaded",function(e){savepage_ShadowLoader(5)},!1)</script><meta content="https://brownmath.com/stat/leastsq.htm"name="savepage-url"><meta content="Least Squares — the Gory Details"name="savepage-title"><meta content="Unknown"name="savepage-pubdate"><meta content="https://brownmath.com/stat/leastsq.htm"name="savepage-from"><meta content="Fri Apr 25 2025 18:00:40 GMT-0300 (Horário Padrão de Brasília)"name="savepage-date"><meta content="Standard Items; Retain cross-origin frames; Merge CSS images; Remove unsaved URLs; Load lazy images in existing content; Max frame depth = 5; Max resource size = 50MB; Max resource time = 10s;"name="savepage-state"><meta content="28.11"name="savepage-version"><meta content=""name="savepage-comments"><body class="bottompadding"><div id="crummenu"><a href="https://brownmath.com/index.htm"data-savepage-href="../index.htm">BrownMath.com</a> → <a href="https://brownmath.com/stat/index.htm"data-savepage-href="index.htm">Statistics</a> → Least Squares<div id="crumrevdate">Updated 22 Oct 2020 <span class="nonprint">(<a href="#WhatsNew">What’s New?</a>)</span></div></div><div class="maintitle"><h1>Least Squares — the Gory Details<br><small>How Do We Find the Line of Best Fit?</small></h1><p>Copyright © 2002–2025 by Stan Brown, <a href="https://brownmath.com/index.htm"data-savepage-href="../index.htm"><span style="color:brown">BrownMath.com</span></a></div><p class="brk">You have a set of observed points (<i>x</i>,<i>y</i>). You’ve plotted them and they seem to be pretty much linear. How do you find the line that best fits those points?<p class="nonbrk">“Don’t be silly,” you say. “<a href="https://brownmath.com/swt/chap04.htm#c04_regress_root"data-savepage-href="../swt/chap04.htm#c04_regress_root">Put them into a TI-83</a> or Excel and look at the answer.”<p class="nonbrk">Okay, you got me. I’ll ask a deeper question: How does the calculator find the answer? What are the underlying equations?<div class="begdon fr"><span class="nonprint"><a href="https://www.paypal.com/webscr?cmd=_donations&business=stan_paypal@fastmail.fm&item_name=BrownMath%20donation:%20stat/leastsq.htm&currency_code=USD">Because this article helps you,<br>please click to donate!</a></span><span class="onlyprint">Because this article helps you,<br>please donate at<br>BrownMath.com/donate.</span></div><div class="Summary"id="TOC0"><span class="SummaryH"><strong class="key">Contents:</strong></span><ul class="TOC"><li><a href="#DefBestFit">What Do We Mean by the “Best” Line?</a><li><a href="#Find">How Do We Find That Best Line?</a><ul><li><a href="#History">Historical Note</a><li><a href="#FindCalc">The Calculus Way</a><li><a href="#FindNocalc">The Calculus-Free Way</a><li><a href="#FindShortcut">Shortcut Solution</a></ul><li><a href="#Example">Example</a><li><a href="#Alternative">Alternative Formulas</a><li class="nonprint"><a href="#WhatsNew">What’s New?</a></ul></div><p class="Summary"id="SeeAlso1"><span class="SummaryH"><strong class="key">See also:</strong></span> The least-squares method involves summations. If you’re shaky on your ∑ (sigma) notation, see “<a href="https://brownmath.com/swt/chap01.htm#c01_BigSigma"data-savepage-href="../swt/chap01.htm#c01_BigSigma">∑ Means Add ’em Up</a>”.<h2 id="DefBestFit">What Do We Mean by the “Best” Line?</h2><p>To answer that question, first we have to agree on <strong class="key">what we mean by the “best fit”</strong> of a line to a set of points. Why do we say that the line on the left fits the points better than the line on the right? And can we say that some other line might fit them better still?<p class="illo"><img alt="five points with line fitting well"data-savepage-currentsrc="https://brownmath.com/stat/pic/leastsq1.gif"data-savepage-src="pic/leastsq1.gif"height="136"src="data:image/gif;base64,R0lGODdhyACIAIABAAAAAP///ywAAAAAyACIAAAC/4SPqcvtD6OctNqLs968+88F4kiW5omm6sq27gvH8mwi9I3n+s73qB0z+IbEopEHhAmPzKbzmXwtn9SqlRZ1Ta/crneUbW2/5DIzzBqb12wdeqVuy+fagyxOz+tJQHwNsBcoKNIHKGY4mDgX9UaIqAhpxmiX4hd5SfWmwPeI6VmlmcD5SQpKmbZQqnrUWMKwCjvU+jcba1tnSXt6y3u3i/raKwzcCdcwjFz5e7hV6+hW7As9nZOrbK3LiR2wrdKtTI3z/RPNXO59zr2cHOvsmu7OfhkPlq5tLw9J/2yeD7uvztc4f20ADgRIcI1BfOgGJvSyUNy6h3Qi7kBIEcpEdP9INmYkY9EHxo9EQvYYSVKkR3JnVqZk5fJPS4cvoR1keDFmzZw3M+ncWe1nvXD9hgYligUnxxkmkyrZRXPU0akSky4BgTWr1q1cU9W72jWs2LFkj31ValSSKKA3mn7ZxNYqWn4g16JM6ZYL3Lsk814Bmy2usZ5lAL+LmtGvFbjkEPtTbKoVX3mQA00WVnnP5V6ZBwXDK5Quqc99Qwf8txY04VWMS69W5eBj50SxE5t2TNt0qdm7dY++PRe270i8UeP2DBwx7uU4wzBHKiV5cKlVqQ4u9tz609eyh+cpPmyzQuBxxUMkz9Z8F/AE1fvknt57XfiC1bkvwp5ia8vo6zf/nB5ZcMc9dF9H9PnXGIAzCajgTgW21R+C0Q1oE4MSBiHfSRFeuF2DFUrDoUAeBnVgiLiMKCKIJjKVYYoYrtghWBRepyKMxMiIYlEdVscjhNDFiJ1LNC2k3IjZ9SiiGrUMuaGN13ikXn4c7ndYjvfU6KQsLdpnYZb4bSmllxM2GKaYOrJYopkq3ZSmmgYy2KabazbXpJxGuFOmnWjCU6eeMFmSp59yBfaUoHotE6ihPp6FpaKmXPmio2rFKakTRJJpZKY/RorkmC46pR2LmxYa6omNVorhpaeiOiabXbIq6mk7cgprpK6uWut1t9Ka64m7ktprgLgG+yWlxL457LFzQCarLLK8Nlvsq9De2ee0zgJrbUnVZkuitNxqaOy3s2IrLk/eltstuoVtqe6g7Z4347tAlkVvvfbei2+++u7bQAEAOw=="width="200">       <img alt="five points with line fitting poorly"data-savepage-currentsrc="https://brownmath.com/stat/pic/leastsq2.gif"data-savepage-src="pic/leastsq2.gif"height="136"src="data:image/gif;base64,R0lGODdhyACIAIABAAAAAP///ywAAAAAyACIAAAC/4SPqcvtD6OctNqLs968+88F4kiW5omm6sq27gvH8mwi9I3n+s73qB0z+IbEopEHhAmPzKbzmXwtn9SqlRZ1Ta/crneUbW2/5DIzzBqb12wdeqVuy+fagyxOz+tJbxV+DzjXl/IXaGg2+ANwyChoF7TYKIn4qBQ5idmVeFKY6Vm0yZfwSdoUCjZaqkp0KqKwCtvTGvAaa4szW3u7C9lZossbnFYpRXx3eeM77IaM1TyjzGksNm3JfJ0T7fd87KyNKhxO/e3KLX5eTk5rji4+W94ej6quLk/6vm4fj1+vn8nPzp8tgALPESwY7iDCYAoX7mrocGA1OAEjfoJocRXGjP+lNkLChqsiNZDJRCqiZ5IiSWcroaXc5i0SiJk0a9q8uUDUEpw8e/r86UCnzJzSOErcSbTGS6OGBgUtA4yppUJPyUSVWgflVSdIsR7TmspKV69Tl8L7lRRUWLLjzOZDu1XWWrYUUWadS/eKR6Vx80KZCLMkAy599wEm5FZoYSOL0e3NlpbVUIePQzYOeRZh5SGDd1x2d1iR2MiCQzs2rZTSZ7KbuZL2K7Rbns5+W2t67RVgv8wlhwHbDQ5yy7tfEwfHXHctcN4shbu02xG3PNuAaBekPsm6QdRoGUrnhV1V1Vjho2vXyF2UxfOSyntfPTv9cans40PHWp+O+4X5v+z/1/ydF/8Z1Z9r98F2El6jHYjgXfjEJFuDxcBnmVvLSbgOhW1FiGFMDybHYYd8cTdeWSGKqFhKJU5ooXypOYdcjM+5CFeAGbYI3IU6GqdeaTk24FuLKCZ4IZHEDIifgp6lheSQZ9BYpJNqMSglG01WKRmVWEIFJY9bTinkl1Z2KeaYWpZJGJlocnnmmlVc6WZpJ8b5ppp0ptnmnU/mqSdjXf443Ecw9jaoib14uWOg1hTqEoSC9skiWHNCiphuYVI60luGLorpMpqyOGmnNUr6qKiV/nmpqX7yqSpkrLYqZ6mw+gDnrDWGamusnOaKhJ28Lvnqr8TJKqyuxRQLbKrIJDq667Iz4upskNHqReO0FVpbZ5TYBglUt95+C2644o5L7gMFAAA7"width="200"><p class="brk">Intuitively, we think of a <em>close</em> fit as a <em>good</em> fit. We look for a line with little space between the line and the points it’s supposed to fit. We would say that the best fitting line is the one that has <strong class="key">the least space between itself and the data points</strong>, which represent actual measurements.<p>Okay, what do we mean by “least space”? There are three ways to measure the space between a point and a line: vertically in the <i>y</i> direction, horizontally in the <i>x</i> direction, and on a perpendicular to the line. We choose to <strong class="key">measure the space vertically</strong>. Why? Because our whole purpose in making a regression line is to use it to predict the <i>y</i> value for a given <i>x</i>, and the vertical distances are how far off the predictions would be for the points we actually measured.<p id="U20180513a">That vertical deviation, or prediction error, is called the <strong class="key">residual</strong>, <i>y</i>−<i>ŷ</i>. Since the line predicts a <i>y</i> value (symbol <i>ŷ</i>) for every <i>x</i> value, and there’s an actual measured <i>y</i> value for every <i>x</i> value, there is a residual for every <i>x</i> value in the data set.<p>For example, suppose the line is <i>y</i>=3<i>x</i>+2 and we have a measured data point (2,9). The actual <i>y</i> is 9 and the line predicts <i>ŷ</i>=3·2+2=8. Subtracting, we can say that the residual for <i>x</i>=2, or the residual for the point (2,9), is 9−8 = 1. This is a positive number because the actual value is greater than the predicted value, and the line passes below the data point (2,9). In general, between any given point (<i>x</i>,<i>y</i>) and the line <i>y</i>=<i>m</i><i>x</i>+<i>b</i> the residual (vertical gap) is <i>y</i>−(<i>m</i><i>x</i>+<i>b</i>).<p>But each residual could be negative or positive, depending on whether the line passes above or below that point. We can’t simply add up residuals, because then a line would be considered good if it fell way below some points as long as it fell way above others. To prevent that, we’ll <strong class="key">square each residual</strong>, and add up the squares. (This also has the desirable effect that a few small deviations are more tolerable than one or two big ones.)<p>And at long last we can say exactly what we mean by the line of best fit. If we compute the residual for every point, square each one, and add up the squares, we say the line of best fit is the line for which that sum is the least. Since it’s a sum of squares, the method is called the <strong class="key">method of least squares</strong>.<h2 id="Find">How Do We Find That Best Line?</h2><p>It’s always a giant step in finding something to get clear on what it is you’re looking for, and we’ve done that. The best-fit line, as we have decided, is the line that <strong class="key">minimizes the sum of squares of residuals</strong>. For any given line <i>y</i>=<i>m</i><i>x</i>+<i>b</i>, we can write that sum as<p class="algebra"id="U20180513b"><i>E</i>(<i>m</i>,<i>b</i>) = ∑(<i>y</i> − <i>ŷ</i>)²<p class="secondhalf">where <i>ŷ</i> is the predicted value for a given <i>x</i>, namely <i>m</i><i>x</i>+<i>b</i>, and <i>y</i> is the actual value measured for that given <i>x</i>.<p class="btw"id="U20180513f"><i>E</i> is a function of <i>m</i> and <i>b</i> because the sum of squared residuals is different for different lines <i>y</i>=<i>m</i><i>x</i>+<i>b</i>. <i>E</i> is <em>not</em> a function of <i>x</i> and <i>y</i> because the data points are what they are, and don’t change within any given problem.<p class="brk">Do we just try a bunch of lines, compute their <i>E</i> values, and pick the line with the lowest <i>E</i> value? <span id="U20180513t">No, it would be a lot of work without proving anything — a lose-lose — because</span> we could never be sure that there wasn’t some other line with still a lower <i>E</i>.<p>Instead, we use a <strong class="key">powerful and common trick</strong> in mathematics: We <em>assume</em> we know the line, and use its properties to help us find its identity. Here’s how that works.<p>What is the line of best fit? It’s <i>y</i>=<i>m</i><i>x</i>+<i>b</i>, because <em>any</em> line (except a vertical one) is <i>y</i>=<i>m</i><i>x</i>+<i>b</i>. We happen not to know <i>m</i> and <i>b</i> just yet, but we can use the properties of the line to find them.<p>What is the <strong class="key">chief property of the line</strong>? It is that <i>E</i> is less for this line than for any other line that might pass through the same set of points. In other words, <strong class="key"><i>E</i>(<i>m</i>,<i>b</i>) is minimized by varying <i>m</i> and <i>b</i></strong>. Let’s look at how we can write an expression for <i>E</i> in terms of <i>m</i> and <i>b</i>, and of course using the measured data points (<i>x</i>,<i>y</i>).<p class="brk"id="U20180513c">The squared residual for any one point follows from the definition I gave earlier:<p class="algebra">residual² = (<i>y</i> − <i>ŷ</i>)² = (<i>y</i> − (<i>m</i><i>x</i>+<i>b</i>))²<p class="secondhalf">Since (A−B)² = (B−A)², let’s reverse the subtraction to get rid of a layer of parentheses:<p class="algebra">residual² = (<i>y</i> − <i>ŷ</i>)² = (<i>m</i><i>x</i> + <i>b</i> − <i>y</i>)²<p class="secondhalf">Now multiply:<p class="algebra"id="U20180513d">residual² = (<i>y</i> − <i>ŷ</i>)² = <i>m</i>²<i>x</i>² + 2<i>b</i><i>m</i><i>x</i> + <i>b</i>² − 2<i>m</i><i>x</i><i>y</i> − 2<i>b</i><i>y</i> + <i>y</i>²<p class="brk">The sum of squared residuals for a line <i>y</i>=<i>m</i><i>x</i>+<i>b</i> is found by summing over all points:<p class="algebra"id="U20180513e"><i>E</i>(<i>m</i>,<i>b</i>) = ∑residual² = ∑(<i>y</i> − <i>ŷ</i>)²<p class="algebra"><i>E</i>(<i>m</i>,<i>b</i>) = ∑(<i>m</i>²<i>x</i>² + 2<i>b</i><i>m</i><i>x</i> + <i>b</i>² − 2<i>m</i><i>x</i><i>y</i> − 2<i>b</i><i>y</i> + <i>y</i>²)<p class="algebra"><i>E</i>(<i>m</i>,<i>b</i>) = <i>m</i>²∑<i>x</i>² + 2<i>b</i><i>m</i>∑<i>x</i> + <i>n</i><i>b</i>² − 2<i>m</i>∑<i>x</i><i>y</i> − 2<i>b</i>∑<i>y</i> + ∑<i>y</i>²<p class="secondhalf">Once we find the <i>m</i> and <i>b</i> that minimize <i>E</i>(<i>m</i>,<i>b</i>), we’ll know the exact equation of the line of best fit.<p class="btw"id="U20180414a">Incidentally, why is there no ∑ in the third term of the final expression for <i>E</i>(<i>m</i>,<i>b</i>)? Because <i>b</i>² in the previous line is a property of the line that we’re looking for and doesn’t vary from point to point. Adding up <i>b</i>² once for each of the <i>n</i> points gives <i>n</i><i>b</i>².<p class="brk">As soon as you hear “minimize”, you think “calculus”. <span id="U20180414b">(Well, you do if you’ve <em>taken</em> calculus!)</span> And indeed calculus can find <i>m</i> and <i>b</i>. Surprisingly, we can also find <i>m</i> and <i>b</i> using <a href="#FindNocalc">plain algebra</a>.<h3 id="History">Historical Note</h3><p>It’s not entirely clear who invented the method of least squares. Most authors attach it to the name of Karl Friedrich Gauss (1777–1855), who first published on the subject in 1809.<p>But the Frenchman Adrien Marie Legendre (1752–1833) “published a clear explanation of the method, with a worked example, in 1805” according to Stephen Stigler in <cite>Statistics on the Table</cite> (Cambridge, Massachusetts; Harvard University Press, 1999; see Chapter 17). In setting up the new metric system of measurement, the meter was to be fixed at a ten-millionth of the distance from the North Pole through Paris to the Equator. Surveyors had measured portions of that arc, and Legendre invented the method of least squares to get the best measurement for the whole arc.<h3 id="FindCalc">The Calculus Way</h3><p>Using calculus, a function has its <strong class="key">minimum where the derivative is 0</strong>. Since we need to adjust both <i>m</i> and <i>b</i>, we take the <strong class="key">partial derivative</strong> of <i>E</i> with respect to <i>m</i>, and separately with respect to <i>b</i>, and set both to 0:<p class="algebra"id="U20180513g"><i>E<sub>m</sub></i> = 2<i>m</i>∑<i>x</i>² + 2<i>b</i>∑<i>x</i> − 2∑<i>x</i><i>y</i> = 0 <span class="yields">⇒</span> m∑<i>x</i>² + <i>b</i>∑<i>x</i> = ∑<i>x</i><i>y</i><p class="secondhalf">and<p class="algebra"><i>E<sub>b</sub></i> = 2m∑<i>x</i> + 2<i>n</i><i>b</i> −2∑y = 0 <span class="yields">⇒</span> <i>m</i>∑<i>x</i> + bn = ∑<i>y</i><p class="secondhalf">Each equation then gets divided by the common factor 2, and the terms not involving <i>m</i> or <i>b</i> are moved to the other side. With a little thought you can recognize the result as two simultaneous equations in <i>m</i> and <i>b</i>, namely:<p class="algebra"id="U20180513h">(∑<i>x</i>²)<i>m</i> + (∑<i>x</i>)<i>b</i> = ∑<i>x</i><i>y</i>   and   (∑<i>x</i>)<i>m</i> + <i>n</i><i>b</i> = ∑<i>y</i><p class="secondhalf">The summation expressions are all just numbers, the results of summing <i>x</i> and <i>y</i> in various combinations.<p class="brk">These simultaneous equations can be solved like any others: by substitution or by linear combination. Let’s try substitution. The second equation looks easy to solve for <i>b</i>:<p class="algebra"id="U20180513i"><i>b</i> = (∑<i>y</i> − <i>m</i>∑<i>x</i>) / <i>n</i><p class="secondhalf">Substitute that in the other equation and you eventually come up with<p class="algebra"id="U20180513j"><i>m</i> = ( <i>n</i>∑<i>x</i><i>y</i> − (∑<i>x</i>)(∑<i>y</i>) ) / ( <i>n</i>∑<i>x</i>² − (∑<i>x</i>)² )<p class="algebra"><i>b</i> = ( (∑<i>x</i>²)(∑<i>y</i>) − (∑<i>x</i>)(∑<i>x</i><i>y</i>) ) / ( <i>n</i>∑<i>x</i>² − (∑<i>x</i>)² )<p class="secondhalf">And that is very probably what your calculator (or Excel) does: Add up all the <i>x</i>’s, all the <i>x</i>², all the <i>x</i><i>y</i>, and so on, and compute the coefficients. It’s tedious, but not hard. (Usually these equations are presented in the shortcut form <a href="#FindShortcut">shown later</a>.)<div class="btw"id="U20180506a">How do we know that this <i>m</i> and <i>b</i> will give us a minimum <i>E</i> and not a maximum or saddle point? <span id="U20180513q">It’s obvious that no matter how badly a line fits, no matter how large its <i>E</i>(<i>m</i>,<i>b</i>), it’s always possible to find a worse line, one that is further away from all the points. It seems reasonable that there should be a best line, one that can’t be improved on, but can we prove that?</span><p class="nonbrk">There is a second derivative test for two variables, but it’s more complicated than the second derivative test for one variable. You have a minimum <i>E</i> for particular values of <i>m</i> and <i>b</i> if three conditions are all met:<p class="nonbrk">(a) The first partial derivatives <i>E<sub>m</sub></i> and <i>E<sub>b</sub></i> must both be 0. That’s how we came up with <i>m</i> and <i>b</i> in the first place, so this condition is met.<p class="nonbrk">(b) The <strong class="key">determinant of the Hessian matrix</strong> must be positive. For independent variables <i>m</i> and <i>b</i>, that determinant is defined in terms of second partial derivatives as<p class="algebra"id="U20180513r"><i>D</i> = <i>E<sub>mm</sub></i> <i>E<sub>bb</sub></i> − (<i>E<sub>mb</sub></i>)²<p class="secondhalf">which evaluates to<p class="algebra"><i>D</i> = (2∑<i>x</i>²)(2<i>n</i>) − (2∑<i>x</i>)²<p class="algebra"><i>D</i> = 4<i>n</i>∑<i>x</i>² − 4(∑<i>x</i>)² = 4[<i>n</i>∑<i>x</i>² − (∑<i>x</i>)²]<p class="secondhalf"id="U20180513s">The average of the <i>x</i>’s is <i><i><span class="unicode">x̅</span></i> = ∑<i>x</i>/<i>n</i></i>, so <i>∑<i>x</i> = <i>n</i><i><span class="unicode">x̅</span></i></i> and<p class="algebra"><i>D</i> = 4(<i>n</i>∑<i>x</i>² − <i>n</i>²<i><span class="unicode">x̅</span></i>²) = 4<i>n</i>(∑<i>x</i>² − <i>n</i><i><span class="unicode">x̅</span></i>²)<p class="secondhalf">Remember, we need to show that this is positive in order to be sure that our <i>m</i> and <i>b</i> minimize the sum of squared residuals <i>E</i>(<i>m</i>,<i>b</i>). To show that, consider the sum of the squares of deviations between each <i>x</i> value and the average of all <i>x</i>’s:<p class="algebra">∑(<i>x</i>−<i><span class="unicode">x̅</span></i>)² = ∑(<i>x</i>² − 2<i>x</i><i><span class="unicode">x̅</span></i> + <i><span class="unicode">x̅</span></i>²)<p class="algebra">∑(<i>x</i>−<i><span class="unicode">x̅</span></i>)² = ∑<i>x</i>² − 2<i><span class="unicode">x̅</span></i>∑<i>x</i> + <i>n</i><i><span class="unicode">x̅</span></i>²<p class="secondhalf">But ∑<i>x</i>/<i>n</i> = <i><span class="unicode">x̅</span></i>, so ∑<i>x</i> = <i>n</i><i><span class="unicode">x̅</span></i> and<p class="algebra">∑(<i>x</i>−<i><span class="unicode">x̅</span></i>)² = ∑<i>x</i>² − 2<i>n</i><i><span class="unicode">x̅</span></i>² + <i>n</i><i><span class="unicode">x̅</span></i>²<p class="algebra">∑(<i>x</i>−<i><span class="unicode">x̅</span></i>)² = ∑<i>x</i>² − <i>n</i><i><span class="unicode">x̅</span></i>²<p class="secondhalf">Look back at <i>D</i> = 4<i>n</i>(∑<i>x</i>²−<i>n</i><i><span class="unicode">x̅</span></i>²). 4<i>n</i> is positive, since the number of points <i>n</i> is positive. The quantity in parentheses must be positive because it equals <i>∑(<i>x</i>−<i><span class="unicode">x̅</span></i>)²</i>, which is a sum of squares. <i>D</i> is the product of two positive numbers, so <i>D</i> itself is positive, and this condition is met.<p class="nonbrk">(c) The second partial derivative with respect to either variable must be positive. We have <i><i>E<sub>bb</sub></i> = 2<i>n</i></i>, which is positive, and therefore this condition is met. (It doesn’t matter which variable you use; if condition (b) is met, then either both second derivatives are positive or both are negative.)<p class="nonbrk">Thus all three conditions are met, apart from pathological cases like all points having the same <i>x</i> value, and the <i>m</i> and <i>b</i> you get from solving the equations do minimize the total of the squared residuals, <i>E</i>(<i>m</i>,<i>b</i>).</div><h3 id="FindNocalc">The Calculus-Free Way</h3><p>But you <strong class="key">don’t need calculus</strong> to solve every minimum or maximum problem. Look back again at the equation for <i>E</i>, which is the quantity we want to minimize:<p class="algebra"><i>E</i>(<i>m</i>,<i>b</i>) = <i>m</i>²∑<i>x</i>² + 2<i>b</i><i>m</i>∑<i>x</i> + <i>n</i><i>b</i>² − 2<i>m</i>∑<i>x</i><i>y</i> − 2<i>b</i>∑<i>y</i> + ∑<i>y</i>²<p class="brk">Now that may look intimidating, but remember that all the sigmas are just constants, formed by adding up various combinations of the (<i>x</i>,<i>y</i>) of the original points. In fact, collecting like terms reveals that <i>E</i> is really <strong class="key">just a parabola</strong> with respect to <i>m</i> or <i>b</i>:<p class="algebra"id="U20180513o"><i>E</i>(<i>m</i>) = (∑<i>x</i>²)<i>m</i>² + (2<i>b</i>∑<i>x</i> − 2∑<i>x</i><i>y</i>)<i>m</i> + (<i>n</i><i>b</i>² − 2<i>b</i>∑<i>y</i> + ∑<i>y</i>²)<p class="algebra"><i>E</i>(<i>b</i>) = <i>n</i><i>b</i>² + (2<i>m</i>∑<i>x</i> − 2∑<i>y</i>)<i>b</i> + (<i>m</i>²∑<i>x</i>² − 2<i>m</i>∑<i>x</i><i>y</i> + ∑<i>y</i>²)<p class="brk">Both these parabolas are <strong class="key">open upward</strong>. (Why? because the coefficients of the <i>m</i>² and <i>b</i>² terms are positive. The sum of <i>x</i>² must be positive unless all <i>x</i>’s are 0; and of course <i>n</i>, the number of points, is positive.) Since the parabolas are open upward, each one has a <strong class="key">minimum at its vertex</strong>.<p>Where is the vertex for each of these parabolas? Well, recall that a parabola <i>y</i>=<i>p</i><i>x</i>²+<i>q</i><i>x</i>+<i>r</i> has its vertex at -<i>q</i>/2<i>p</i>. These are parabolas in <i>m</i> and <i>b</i>, not in <i>x</i>, but you can find the vertex of each one the same way:<p class="algebra"id="U20180513p">The vertex of <i>E</i>(<i>m</i>) is at <i>m</i> = ( −2<i>b</i>∑<i>x</i> + 2∑<i>x</i><i>y</i> ) / 2∑<i>x</i>² = ( ∑<i>x</i><i>y</i> − <i>b</i>∑<i>x</i> ) / ∑<i>x</i>²<p class="algebra">The vertex of <i>E</i>(<i>b</i>) is at <i>b</i> = ( −2<i>m</i>∑<i>x</i> + 2∑<i>y</i> ) / 2<i>n</i> = ( ∑<i>y</i> − <i>m</i>∑<i>x</i> ) / <i>n</i><p class="secondhalf">Now there are two equations in <i>m</i> and <i>b</i>. Substitute one into the other one, perhaps the second into the first, and the solution is<p class="algebra"id="U20180513k"><i>m</i> = ( <i>n</i>∑<i>x</i><i>y</i> − (∑<i>x</i>)(∑<i>y</i>) ) / ( <i>n</i>∑<i>x</i>² − (∑<i>x</i>)² )<p class="algebra"><i>b</i> = ( (∑<i>x</i>²)(∑<i>y</i>) − (∑<i>x</i>)(∑<i>x</i><i>y</i>) ) / ( <i>n</i>∑<i>x</i>² − (∑<i>x</i>)² )<p class="secondhalf">These are exactly the equations obtained by the <a href="#FindCalc">calculus method</a>.<h3 id="FindShortcut">Shortcut Solution</h3><p class="brk"id="U20180513m">The formula for <i>m</i> is bad enough, and the formula for <i>b</i> is a monstrosity. But if you compute <i>m</i> first, then it’s easier to compute <i>b</i> using <i>m</i>:<p class="algebra"id="U20180513l"><i>m</i> = ( <i>n</i>∑<i>x</i><i>y</i> − (∑<i>x</i>)(∑<i>y</i>) ) / ( <i>n</i>∑<i>x</i>² − (∑<i>x</i>)² )<p class="algebra"><i>b</i> = ( ∑<i>y</i> − <i>m</i>∑<i>x</i> ) / <i>n</i><h2 id="Example">Example</h2><p>Just to make things more concrete, here’s an example. Suppose that <i>x</i> is dial settings in your freezer, and <i>y</i> is the resulting temperature in °F. Here’s the full calculation:<div class="acchild"><table class="acchild"><tr><th><i>n</i>=5<th><i>x</i><th><i>y</i><th><i>x</i>²<th><i>x</i><i>y</i><tr><td> <td> 0<td>  6<td> 0<td>   0<tr><td> <td> 2<td> −1<td> 4<td>  −2<tr><td> <td> 3<td> −3<td> 9<td>  −9<tr><td> <td> 5<td>−10<td>25<td> −50<tr><td> <td> 6<td>−16<td>36<td> −96<tr><td class="ar">∑<td>16<td>−24<td>74<td>−157</table></div><p>Now compute <i>m</i> and <i>b</i>:<pre>            5(−157) − (16)(−24)
        m = -------------------
                5(74) − 16²

            −401
        m = ----
             114

        m = −3.5175

             −24 − (−3.5175)(16)
        b = --------------------
                      5

            32.28
        b = ----- = 6.456
              5</pre><p>“These values agree precisely with the regression equation calculated by a TI-83 for the same data,” he said smugly.<h2 id="Alternative">Alternative Formulas</h2><p>Some authors give a different form of the solutions for <i>m</i> and <i>b</i>, such as:<p class="algebra"id="U20180513n"><i>m</i> = ∑(<i>x</i>−<i><span class="unicode">x̅</span></i>)(<i>y</i>−<i><span class="unicode">y̅</span></i>) / ∑(<i>x</i>−<i><span class="unicode">x̅</span></i>)²   and   <i>b</i> = <i><span class="unicode">y̅</span></i> − <i>m</i><i><span class="unicode">x̅</span></i><p class="secondhalf">where <i><span class="unicode">x̅</span></i> and <i><span class="unicode">y̅</span></i> are the average of all <i>x</i>’s and average of all <i>y</i>’s.<p>These formulas are equivalent to the ones we derived earlier. (Can you prove that? Remember that <i>n</i><i><span class="unicode">x̅</span></i> is ∑ <i>x</i>, and similarly for <i>y</i>.) While the <i>m</i> formula looks simpler, it requires you to compute mean <i>x</i> and mean <i>y</i> first. If you do that, here’s how the numbers work out:<div class="acchild"><table class="acchild"><tr><th><i>n</i>=5<th><i>x</i><th><i>y</i><th> <i>x</i>−<i><span class="unicode">x̅</span></i> <th> <i>y</i>−<i><span class="unicode">y̅</span></i> <th> (<i>x</i>−<i><span class="unicode">x̅</span></i>)² <th> (<i>x</i>−<i><span class="unicode">x̅</span></i>)(<i>y</i>−<i><span class="unicode">y̅</span></i>) <tr><td> <td> 0  <td>  6  <td>−3.2<td> 10.8<td>10.24<td>−34.56<tr><td> <td> 2  <td> −1  <td>−1.2<td>  3.8<td> 1.44<td> −4.56<tr><td> <td> 3  <td> −3  <td>−0.2<td>  1.8<td>−0.04<td> −0.36<tr><td> <td> 5  <td>−10  <td> 1.8<td> −5.2<td> 3.24<td> −9.36<tr><td> <td> 6  <td>−16  <td> 2.8<td>−11.2<td> 7.84<td>−31.36<tr><td class="ar">∑<td>16  <td>−24  <td> 0  <td>  0  <td>22.8 <td>−80.2 <tr><td>mean<td> 3.2<td> −4.8<td> <td> <td> <td> </table></div><p>Whew! Once you’ve got through that, <i>m</i> and <i>b</i> are only a little more work:<p class="algebra"><i>m</i> = −80.2 / 22.8 = −3.5175<p class="algebra"><i>b</i> = −4.8 − (−3.5175)(3.2) = 6.456<p class="secondhalf">The simplicity of the alternative formulas is definitely deceptive.<div class="nonprint"><h2 id="WhatsNew">What’s New?</h2><ul class="loose purelist"><li><strong class="key">22 Oct 2020</strong>: Converted page from HTML 4.01 to HTML5, italicized the variable names, and cleaned up table formatting. Made a few small textual changes for clarity.<li><strong class="key">13 May 2018</strong>:<ul><li>Replaced “deviations” with the standard term <em>residual</em> starting <a href="#U20180513a">here</a>.<li>Instead of just <i>E</i>, called the sum of squared residuals for a given line <a href="#U20180513b"><i>E</i>(<i>m</i>,<i>b</i>)</a>.<li>Used subscript notation for partial derivatives instead of ∂ fractions, <a href="#U20180513g">here</a> and <a href="#U20180513r">here</a>.<li>Improved <a href="#U20180513s">the proof</a> of condition (b) for the second partial derivative test.<li>Changed equation pictures to text, <a href="#U20180513d">here</a>, <a href="#U20180513e">here</a>, <a href="#U20180513g">here</a>, <a href="#U20180513h">here</a>, <a href="#U20180513i">here</a>, <a href="#U20180513j">here</a>, <a href="#U20180513o">here</a>, <a href="#U20180513p">here</a>, <a href="#U20180513k">here</a>, <a href="#U20180513m">here</a>, <a href="#U20180513l">here</a>, and <a href="#U20180513n">here</a>.<li>Replaced a bunch of en dashes U+2013 with minus signs U+2212, the proper character.</ul><li><strong class="key">6 May 2018</strong>: Following a query from John Stallone, corrected <a href="#U20180506a">a BTW</a> that not only computed the second derivatives incorrectly but used an incomplete second derivative test.<li><strong class="key">14 Apr 2018</strong>: Prompted by a reader’s query, explained <a href="#U20180414a">why ∑<i>b</i>² = <i>n</i><i>b</i>²</a>.<li><strong class="key">9 Aug 2007</strong>: New article.</ul></div><div id="pageend"><div class="begdon"><span class="nonprint"><a href="https://www.paypal.com/webscr?cmd=_donations&business=stan_paypal@fastmail.fm&item_name=BrownMath%20donation:%20stat/leastsq.htm&currency_code=USD">Because this article helps you,<br>please click to donate!</a></span><span class="onlyprint">Because this article helps you,<br>please donate at<br>BrownMath.com/donate.</span></div><p class="onlyprint brmwrapup">Updates and new info: <a href="https://brownmath.com/stat/index.htm"data-savepage-href="index.htm">https://BrownMath.com/stat/</a><p class="nonprint source"><a href="https://brownmath.com/sitemap.htm"data-savepage-href="../sitemap.htm">Site Map</a> | <a href="https://brownmath.com/about/search.htm"data-savepage-href="../about/search.htm">Searches</a> | <a href="https://brownmath.com/index.htm"data-savepage-href="../index.htm">Home Page</a> | <a href="https://brownmath.com/about/index.htm#Contact"data-savepage-href="../about/index.htm#Contact">Contact</a></div>